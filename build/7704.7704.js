(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[7704],{93038:(e,n,t)=>{"use strict";t.r(n),t.d(n,{OpenloginAdapter:()=>P,getOpenloginDefaultOptions:()=>C});var i=t(74187),r=t(4268),o=t(34795),a=t(9249),s=t(87371),c=t(80753),l=t(93069),h=t(45754),p=t(11987),u=t(95058),g=t(56666),d=t(82841),f=t.n(d),E=t(77257),A=t(51344),v=t.n(A),C=function(e,n){return{adapterSettings:{network:i.dr.MAINNET,clientId:"",uxMode:i.$e.POPUP},chainConfig:e?(0,r.getChainConfig)(e,n):null,loginSettings:{}}};function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){(0,g.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P=function(e){(0,h.Z)(m,e);var n,d,A,T,P,S,O,I,y=(O=m,I=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(O);if(I){var t=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,t)}else e=n.apply(this,arguments);return(0,p.Z)(this,e)});function m(e){var n,t,o,s,l;(0,a.Z)(this,m),l=y.call(this),(0,g.Z)((0,c.Z)(l),"name",r.WALLET_ADAPTERS.OPENLOGIN),(0,g.Z)((0,c.Z)(l),"adapterNamespace",r.ADAPTER_NAMESPACES.MULTICHAIN),(0,g.Z)((0,c.Z)(l),"type",r.ADAPTER_CATEGORY.IN_APP),(0,g.Z)((0,c.Z)(l),"openloginInstance",null),(0,g.Z)((0,c.Z)(l),"clientId",void 0),(0,g.Z)((0,c.Z)(l),"status",r.ADAPTER_STATUS.NOT_READY),(0,g.Z)((0,c.Z)(l),"currentChainNamespace",r.CHAIN_NAMESPACES.EIP155),(0,g.Z)((0,c.Z)(l),"openloginOptions",void 0),(0,g.Z)((0,c.Z)(l),"loginSettings",{}),(0,g.Z)((0,c.Z)(l),"privKeyProvider",null),r.log.debug("const openlogin adapter",e);var h=C(null===(n=e.chainConfig)||void 0===n?void 0:n.chainNamespace,null===(t=e.chainConfig)||void 0===t?void 0:t.chainId);if(l.openloginOptions=N(N({clientId:"",network:i.dr.MAINNET},h.adapterSettings),e.adapterSettings||{}),l.clientId=null===(o=e.adapterSettings)||void 0===o?void 0:o.clientId,l.loginSettings=N(N({},h.loginSettings),e.loginSettings),l.sessionTime=l.loginSettings.sessionTime||86400,null!==(s=e.chainConfig)&&void 0!==s&&s.chainNamespace){var p;l.currentChainNamespace=null===(p=e.chainConfig)||void 0===p?void 0:p.chainNamespace;var u=h.chainConfig?h.chainConfig:{};if(l.chainConfig=N(N({},u),null==e?void 0:e.chainConfig),r.log.debug("const openlogin chainConfig",l.chainConfig),!l.chainConfig.rpcTarget&&e.chainConfig.chainNamespace!==r.CHAIN_NAMESPACES.OTHER)throw r.WalletInitializationError.invalidParams("rpcTarget is required in chainConfig")}return l}return(0,s.Z)(m,[{key:"chainConfigProxy",get:function(){return this.chainConfig?N({},this.chainConfig):null}},{key:"provider",get:function(){var e;return(null===(e=this.privKeyProvider)||void 0===e?void 0:e.provider)||null},set:function(e){throw new Error("Not implemented")}},{key:"init",value:(S=(0,o.Z)(f().mark((function e(n){var t,o,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,l.Z)((0,u.Z)(m.prototype),"checkInitializationRequirements",this).call(this),null!==(t=this.openloginOptions)&&void 0!==t&&t.clientId){e.next=3;break}throw r.WalletInitializationError.invalidParams("clientId is required before openlogin's initialization");case 3:if(this.chainConfig){e.next=5;break}throw r.WalletInitializationError.invalidParams("chainConfig is required before initialization");case 5:return o=!1,this.openloginOptions.uxMode===i.$e.REDIRECT&&(a=(0,i.Gv)(),Object.keys(a).length>0&&a._pid&&(o=!0)),this.openloginOptions=N(N({},this.openloginOptions),{},{replaceUrlOnRedirect:o}),this.openloginInstance=new i.ZP(this.openloginOptions),r.log.debug("initializing openlogin adapter init"),e.next=12,this.openloginInstance.init();case 12:if(this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.READY,r.WALLET_ADAPTERS.OPENLOGIN),e.prev=14,r.log.debug("initializing openlogin adapter"),!this.openloginInstance.privKey||!n.autoConnect&&!o){e.next=19;break}return e.next=19,this.connect();case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(14),r.log.error("Failed to connect with cached openlogin provider",e.t0),this.emit("ERRORED",e.t0);case 25:case"end":return e.stop()}}),e,this,[[14,21]])}))),function(e){return S.apply(this,arguments)})},{key:"connect",value:(P=(0,o.Z)(f().mark((function e(n){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,l.Z)((0,u.Z)(m.prototype),"checkConnectionRequirements",this).call(this),this.status=r.ADAPTER_STATUS.CONNECTING,this.emit(r.ADAPTER_EVENTS.CONNECTING,N(N({},n),{},{adapter:r.WALLET_ADAPTERS.OPENLOGIN})),e.prev=3,e.next=6,this.connectWithProvider(n);case 6:return e.abrupt("return",this.provider);case 9:if(e.prev=9,e.t0=e.catch(3),r.log.error("Failed to connect with openlogin provider",e.t0),this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.ERRORED,e.t0),null===e.t0||void 0===e.t0||!e.t0.message.includes("user closed popup")){e.next=16;break}throw r.WalletLoginError.popupClosed();case 16:throw r.WalletLoginError.connectionError("Failed to login with openlogin");case 17:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(e){return P.apply(this,arguments)})},{key:"disconnect",value:(T=(0,o.Z)(f().mark((function e(){var n,t=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:{cleanup:!1},this.status===r.ADAPTER_STATUS.CONNECTED){e.next=3;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet");case 3:if(this.openloginInstance){e.next=5;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 5:return e.next=7,this.openloginInstance.logout();case 7:n.cleanup?(this.status=r.ADAPTER_STATUS.NOT_READY,this.openloginInstance=null,this.privKeyProvider=null):this.status=r.ADAPTER_STATUS.READY,this.emit(r.ADAPTER_EVENTS.DISCONNECTED);case 9:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"authenticateUser",value:(A=(0,o.Z)(f().mark((function e(){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===r.ADAPTER_STATUS.CONNECTED){e.next=2;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet, Please login/connect first");case 2:return e.next=4,this.getUserInfo();case 4:return n=e.sent,e.abrupt("return",{idToken:n.idToken});case 6:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"getUserInfo",value:(d=(0,o.Z)(f().mark((function e(){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===r.ADAPTER_STATUS.CONNECTED){e.next=2;break}throw r.WalletLoginError.notConnectedError("Not connected with wallet");case 2:if(this.openloginInstance){e.next=4;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 4:return e.next=6,this.openloginInstance.getUserInfo();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"setAdapterSettings",value:function(e){if(this.status!==r.ADAPTER_STATUS.READY){var n=C();this.openloginOptions=N(N(N({},n.adapterSettings),this.openloginOptions||{}),e),e.sessionTime&&(this.loginSettings=N(N({},this.loginSettings),{},{sessionTime:e.sessionTime})),e.clientId&&(this.clientId=e.clientId)}}},{key:"setChainConfig",value:function(e){(0,l.Z)((0,u.Z)(m.prototype),"setChainConfig",this).call(this,e),this.currentChainNamespace=e.chainNamespace}},{key:"connectWithProvider",value:(n=(0,o.Z)(f().mark((function e(){var n,o,a,s,c,l,h,p,u,g=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=g.length>0&&void 0!==g[0]?g[0]:{},this.chainConfig){e.next=3;break}throw r.WalletInitializationError.invalidParams("chainConfig is required before initialization");case 3:if(this.openloginInstance){e.next=5;break}throw r.WalletInitializationError.notReady("openloginInstance is not ready");case 5:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.SOLANA){e.next=13;break}return e.next=8,Promise.all([t.e(5429),t.e(2234),t.e(5573),t.e(120)]).then(t.bind(t,85573));case 8:o=e.sent,a=o.SolanaPrivateKeyProvider,this.privKeyProvider=new a({config:{chainConfig:this.chainConfig}}),e.next=26;break;case 13:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.EIP155){e.next=21;break}return e.next=16,Promise.all([t.e(883),t.e(9159),t.e(984)]).then(t.bind(t,29159));case 16:s=e.sent,c=s.EthereumPrivateKeyProvider,this.privKeyProvider=new c({config:{chainConfig:this.chainConfig}}),e.next=26;break;case 21:if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.OTHER){e.next=25;break}this.privKeyProvider=new E.FL,e.next=26;break;case 25:throw new Error("Invalid chainNamespace: ".concat(this.currentChainNamespace," found while connecting to wallet"));case 26:if(this.openloginInstance.privKey){e.next=30;break}return this.loginSettings.curve||(this.loginSettings.curve=this.currentChainNamespace===r.CHAIN_NAMESPACES.SOLANA?i.x7.ED25519:i.x7.SECP256K1),e.next=30,this.openloginInstance.login(v()(this.loginSettings,n,{loginProvider:n.loginProvider},{extraLoginOptions:N(N({},n.extraLoginOptions||{}),{},{login_hint:n.login_hint||(null===(l=n.extraLoginOptions)||void 0===l?void 0:l.login_hint)})}));case 30:if(!(h=this.openloginInstance.privKey)){e.next=42;break}if(this.currentChainNamespace!==r.CHAIN_NAMESPACES.SOLANA){e.next=38;break}return e.next=35,Promise.all([t.e(5429),t.e(9234)]).then(t.bind(t,99234));case 35:p=e.sent,u=p.getED25519Key,h=u(h).sk.toString("hex");case 38:return e.next=40,this.privKeyProvider.setupProvider(h);case 40:this.status=r.ADAPTER_STATUS.CONNECTED,this.emit(r.ADAPTER_EVENTS.CONNECTED,{adapter:r.WALLET_ADAPTERS.OPENLOGIN,reconnected:!n});case 42:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),m}(r.BaseAdapter)},49345:()=>{},72464:()=>{}}]);